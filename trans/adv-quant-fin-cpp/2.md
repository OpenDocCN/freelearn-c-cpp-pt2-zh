# 第二章：数学模型

在上一章中，我们将 Bento Box 模板描述为构建金融衍生品定价方法的一种方法。 在便当盒子模板的上下文中，本章对应于方框 2-数学模型。 在这里，我们回顾了当今金融衍生品市场中用来描述潜在投资者行为的一些关键数学模型。 尤其是潜在的未来演变。 以下是这些基本情况的示例：

*   股权股权或股票
*   一种汇率
*   一种利率
*   信用评级

# 公平性

在权益资产类别中，标的是公司股票的价格。 例如，沃达丰公司(Vodafone PLC，VOD.L)在伦敦证券交易所([www.londonstock exchange.com](http://www.londonstockexchange.com))某一特定时间所报的一股股票的当前价格。 价格可能是 2.32 GB，时间可能是 2013 年 5 月 13 日 11：33：24。

因此，在数学术语中，股票价格可以表示为当前时间*t*的标量函数。 我们将该函数表示为*S(T)*。 请注意，在技术术语中，*S(T)*是一个时间序列，即使表面上是连续的(具有*C[0]*连续性)，但实际上是不连续的(容易发生跳跃)。 此外，它不是行为良好的函数，也就是说，它的一阶导数不存在。

我们将把*S(T)*建模为随机变量。 因此，我们围绕这个值构建的所有构造，例如收益*H(S_T)*的值，都将是随机函数。 在这种情况下，我们不需要使用标准的微积分工具(如泰勒级数、导数、Riemann 积分)，而需要使用随机微积分中的工具(如 Ito 引理、Radon-Nykodym 导数、Riemann-Stieltjes 积分)来推进我们的建模。

在此上下文中，变量*S(T)*的行为可以由 SDE 来描述。 就股票而言，用于描述股票行为的标准 SDE 称为**GBM。** 在所谓的真实世界概率测度*P*下，GBM 在连续时间的形式表示如下：

![Equity](../images/00011.jpeg)

方程式 1

然而，在文献中，这种表示法并没有用于金融衍生品的定价。 在风险中性措施*Q*下，它被以下表述所取代：

![Equity](../images/00012.jpeg)

方程式 2

在前面的等式中，我们用无风险利率![Equity](../images/00014.jpeg)代替了漂移![Equity](../images/00013.jpeg)，![Equity](../images/00015.jpeg)是波动率，*DW*是 Wiener 过程的增量。 方程式 2 可以进一步表示如下：

![Equity](../images/00016.jpeg)

在前面的等式中，我们可以将等式左侧的术语*DS/S*(**LHS**)标识为股权回报。 因此，方程右侧的两个项(**RHS**)是“漂移项”和“波动项”。 这些条款中的每一个都由参数![Equity](../images/00013.jpeg)和![Equity](../images/00017.jpeg)“调整”，这些参数根据当前交易工具(如看涨期权和看跌期权)的市场价格进行校准。

请注意，方程式 2 是用来描述金融衍生品这个词背后的基本方程式。

为了给衍生品定价，我们需要将公式 2 从连续时间转换为离散时间，以模拟股票的行为，比如每天(![Equity](../images/00018.jpeg)天，但在金融领域，我们总是按年率计算，所以![Equity](../images/00019.jpeg)年)。 通过使用 Euler-Murayama 离散化，我们可以很容易地近似公式 2，如下所示：

![Equity](../images/00020.jpeg)

![Equity](../images/00021.jpeg)

![Equity](../images/00022.jpeg)

方程式 3

在前面的方程中，我们将 Wiener 过程的微分近似为δ*t*的平方根乘以具有零均值和标准差 1 的高斯分布的抽头(*N(0，1)*)。 方程 3 是线性迭代方程，我们可以通过具有多个时间步长*S1*、*S2*、…的起始值*S0*来计算。 ，*SN*。 我们只需要参数*r*和*σ*的值，以及用于*ε*值的高斯随机数生成器。

为了计算累积标准正态分布的拉伸值，我们将使用一种称为**Box-Muller**的方法。 Box Muller 方法允许我们将均匀随机数转换为高斯随机数。 这非常有用，因为在许多计算机库中，我们可以找到从均匀分布生成随机数的标准函数(例如，C 中的函数`rand()`)，并且通过 Box Muller 方法，我们可以生成所需的高斯绘图。 我们将在[第 4 章](4.html#QMFO2-f9cfc61bea324a5db85ec5ea1673cdfd "Chapter 4. Equity Derivatives in C++")，*C++*中讨论更多关于这方面的内容。

例如，假设我们想要模拟 ABC 公司股票在接下来四天的行为。 该股票的现值为 100 欧元。 无风险利率为年利率 5%(**年利率)。** )，波动率为 30%pa。 我们该怎么继续呢？

首先，我们为需要值的工作日构建一个时间网格(请注意，一年有 255 个工作日)。 它们是*t0*、*t1*、*t2*、*t3*和*t4*。 它们分别对应于周一、周二、周三、周四和周五。 在金融领域，我们总是按年计算，因此，这些日期对应于![Equity](../images/00023.jpeg)，因此*t0=0*、*t1=1/255*、*t2=2/255*、*t3=3/255*和*t4=4/255*。

然后我们需要股价网格*S(T)*。 它们是*S(T0)*、*S(T1)*、*S(T2)*、*S(T3)*和*S(T4)*，我们将把它们分别分配给星期一、星期二、星期三、星期四和星期五，分别表示为*s0*、*s1*、*S2*、。 *S3*和*S4*。 我们已经知道了*S0*的值，这是(今天观察到的)初始价格，也就是周一的*S0=100*。

在此之前，我们需要从累积标准正态分布中提取一个向量，如下所示：

![Equity](../images/00024.jpeg)

然后，我们可以迭代应用公式 3，以从星期一*s0*的值到星期二*s1*的值，如下所示：

![Equity](../images/00025.jpeg)

或者，我们可以从星期一*s0*的值到星期二*s1*的值，数值如下：

![Equity](../images/00026.jpeg)

然后，我们可以按以下方式计算其余日子的值：

![Equity](../images/00027.jpeg)

![Equity](../images/00028.jpeg)

![Equity](../images/00029.jpeg)

如果我们把这些计算出的股票价格集合放在一起，并将它们与时间作图，我们就会得到下面的图表：

![Equity](../images/00030.jpeg)

模拟股票价格

# 外汇

在外汇资产类别中，标的是汇率的价值。 例如，在某个特定时间，欧元(EUR)和英镑(GBP)之间的当前汇率。 汇率可能是*欧元/英镑=1.31*，这意味着 GB 1 将兑换欧元 1.31，当前时间可能是 2013 年 5 月 13 日 11：33：24。

因此，用数学术语来说，汇率可以表示为函数*X(T)*，它是时间的标量函数，就像股票的情况一样。 因此，汇率*X(T)*被建模为随机变量。 用数学术语来说，*X(T)*的行为是使用 SDE 来描述的，就像在股票的情况下一样。 然而，对于股票，我们使用了 GBM，而对于外汇，我们将使用来自 Garman-Kohlhagen 1983 工作的变量。 根据该模型，汇率的随机微分方程可以表示为：

![Foreign exchange](../images/00031.jpeg)

方程式 4

在前面的等式中，*RD*和*Rf*表示国内和国外的无风险利率。 波动率![Foreign exchange](../images/00015.jpeg)是根据市场报价工具校准的参数。

正如我们前面所做的，在继续为衍生品定价之前，我们需要将方程 1 从连续时间转换为离散时间，以模拟每天(![Foreign exchange](../images/00018.jpeg)天)的汇率行为。

我们再次将 Euler-Murayama 离散化应用于方程 1，将微分*DX*变换为差![Foreign exchange](../images/00032.jpeg)，保持常数*RD*、*Rf*和![Foreign exchange](../images/00015.jpeg)不变，并将 Wiener 过程的微分近似为Δ*t*乘以累积标准正态分布的平方根，如下所示：

![Foreign exchange](../images/00033.jpeg)

![Foreign exchange](../images/00034.jpeg)

![Foreign exchange](../images/00035.jpeg)

方程式 5

与公式 2 的情况一样，公式 5 也是线性迭代方程，我们可以通过具有多个时间步长*X1*、*X2*、…的起始值*X0*来迭代计算。 ，*XN*。 我们只需要参数*RD*、*Rf*和*sigma*的值，以及*ε*的值的高斯随机数生成器。

例如，假设我们想要以营业日的最后一个报价(称为**当日结束**(**EOD**))来模拟未来四天欧元兑美元汇率的行为(称为**End**(**EOD**))。 目前欧元/美元汇价为 1.33.。 国内无风险利率为年利率 5%。 外国无风险利率为年利率 3%，而波动率为年利率 30%。 我们该怎么继续呢？

首先，我们为需要值的工作日构建一个时间网格(请注意，一年有 255 个工作日)。 它们是*T0*、*T1*、*T2*、*T3*和*T4*。 它们分别对应于周一、周二、周三、周四和周五，按年率计算依次对应于*t0=0*、*t1=1/255*、*t2=2/255*、*t3=3/255*和*t4=4/255*。

然后我们需要 EOD 汇率*X(T)*的网格。 它们是*X0*、*X1*、*X2*、*X3*和*X4*。 我们已经知道*X0*的值，这是(今天观察到的)初始外汇汇率，也就是周一的*X0=1.33*。 正如我们前面所做的，在继续之前，我们从累积标准正态分布计算绘图向量，以获得以下结果：

![Foreign exchange](../images/00036.jpeg)

然后，我们可以迭代应用公式 3，以从星期一*X0*的值到星期二*X1*的值，如下所示：

![Foreign exchange](../images/00037.jpeg)

或者，我们可以从星期一*s0*的值到星期二*s1*的值，数值如下：

![Foreign exchange](../images/00038.jpeg)

然后，我们可以按以下方式计算其余日子的值：

![Foreign exchange](../images/00039.jpeg)

![Foreign exchange](../images/00040.jpeg)

![Foreign exchange](../images/00041.jpeg)

如果我们把这些计算出的汇率集合在一起，并将它们绘制成时间的函数，我们就会得到以下图表：

![Foreign exchange](../images/00042.jpeg)

模拟汇率

# 利率

在利率资产类别中，标的是利率。 利率相当复杂。 如果我们考虑“今天的利率是多少？”这个问题，我们就能看到这一点。 答案当然不是简单的“5%pa”，因为我们还需要指定我们想知道的利率(*T*)的到期日。 因此，利息比股票或外汇等对象多一个维度。 虽然目前观察到的权益价值是一个标量，也就是一个单一数字，但当前的利率曲线是一个向量。

例如，让我们考虑一下 2013 年 5 月 13 日观察到的 1 个月、3 个月、6 个月和 12 个月(由[http://www.euribor-ebf.eu/](http://www.euribor-ebf.eu/)公布)的欧元银行间同业拆借利率(EURIBOR)现货利率。 我们将这些由*R(t，T)*引用的即期汇率表示为*R(0，3M)=EURIBOR 3M=1%pa*，*R(0，6M)=EURIBOR 6M=2%pa*，*R(0，9M)=EURIBOR 9M=3%pa*，以及*R(0，12M)=EURIBOR。 请注意，*t=0*，因为我们将 2013 年 5 月 13 日视为当前日期。*

这些利率在未来将如何演变？ 换句话说，我们如何对*R(t，T)*建模？ 我们有以下两个选择，反映了目前文学中的两个模范流派：

*   短率模型
*   市场模式

第一个是最古老的，而第二个是较新的。

在第一个模型中，关键的建模变量是利率的理想化，即所谓的短期利率。 这是一个非常小的利率*DR*，适用于非常短的时间间隔。 为了得到适用于整个期限的利率，我们应该将所有这些小额利率在这段时间内的影响相加或综合起来。 在第二个模型中，关键的建模变量是实际报价或市场利率，如伦敦银行同业拆借利率(LIBOR)。 这就是为什么这些模型通常被称为市场模型，其最著名的版本被称为**Libor 市场模型**。

## 短率模型

在连续的时间内，短率可以用 Vasicek 开发的如下 SDE 表示：

![Short rate models](../images/00043.jpeg)

方程式 6

前面的方程是一个平均回归过程。 参数![Short rate models](../images/00044.jpeg)是平均回归水平，![Short rate models](../images/00045.jpeg)是平均回归速度，![Short rate models](../images/00046.jpeg)是波动率。 参数![Short rate models](../images/00044.jpeg)、![Short rate models](../images/00045.jpeg)和![Short rate models](../images/00046.jpeg)控制随机过程的行为。 分配给![Short rate models](../images/00044.jpeg)的值将是利率将趋向的长期利率水平，而![Short rate models](../images/00045.jpeg)将控制利率返回到长期平均水平的速度。 波动性![Short rate models](../images/00046.jpeg)控制着过程“跳跃”的幅度。 这些参数可以根据市场报价工具进行校准，例如利率掉期期权(称为**掉期**)。

我们可以通过前面描述的 Euler-Murayama 方法来近似Vasicek 过程，以获得随机过程的离散化版本，如下所示：

![Short rate models](../images/00047.jpeg)

![Short rate models](../images/00048.jpeg)

![Short rate models](../images/00049.jpeg)

方程式 7

前面的方程是线性迭代方程，我们可以通过对多个时间步长*R1*、*R2*、…的起始值*R0*进行迭代计算。 ，*Rn*。 我们只需要参数*θ*、*λ*和*sigma*的值，以及*ε*的值的高斯随机数生成器。

例如，假设我们想要模拟未来四天的短期利率行为。 目前的利率是百分之五。 当波动率为 30%pa 时，参数![Short rate models](../images/00045.jpeg)=1.0 和![Short rate models](../images/00044.jpeg)=2.0。 我们该怎么继续呢？

首先，我们为需要值的日期构建一个时间网格。 它们是*t0*、*T1*、*T2*、*T3*和*T4*，以对应周一(*t0*)、周二(*T1*)、周三(*T2*)、周四(*T3*)和周五(*T4*)。 依次对应于*T0=0*、*T1=1/365*、*T2=2/365*、*T3=3/365*和*T4=4/365*。

然后我们需要短期利率*r(T)*的网格。 它们是*R0*、*R1*、*R2*、*R3*和*R4*。 我们将把他们分别分配到星期一、星期二、星期三、星期四和星期五。 因为我们已经知道*R0*的值，也就是初始利率(今天观察到的)，我们在周一有*R0=5%*。

正如我们前面所做的，在继续之前，我们从累积标准正态分布计算绘图向量，以获得以下结果：

![Short rate models](../images/00036.jpeg)

然后，我们可以迭代应用公式 3，以从星期一*R0*的值到星期二*R1*的值，如下所示：

![Short rate models](../images/00050.jpeg)

或者，我们可以从星期一*s0*的值到星期二*s1*的值，数值如下：

![Short rate models](../images/00050.jpeg)

![Short rate models](../images/00051.jpeg)

然后，我们可以按以下方式计算其余日子的值：

![Short rate models](../images/00052.jpeg)

![Short rate models](../images/00053.jpeg)

![Short rate models](../images/00054.jpeg)

## 市场模型

**Libor Market Model**(**LMM)**是一种用于为利率衍生品定价的高级数学模型。 LMM 也被称为 BGM 模型，以其作者(Brace，Gatarek，Musiela，1997)的名字命名，已经成为全球金融市场的霸主。 文学提供了关于 LMM 的广泛出版物，主要是它的许多变种和复杂的高级问题。

事实上，LMM 不能理解为一个单一的模型，而可以理解为一个大的模型家族(Rebonato 1998)和(Brigo And Mercurio 2006)。 它的许多变体包括考虑的因素的数量，使用的波动性建模的类型，使用的相关性建模的类型，是否使用随机波动率或 SABR，是否使用远期 LIBOR 利率或掉期利率，以及是否使用半解析或数值求解方法等。

我们的方法和符号密切遵循(Pelsser 2000)的方法和符号，后者虽然简洁，但对 LMM 提供了清晰的介绍。 在这项工作中，我们从 LMM 的所有可能变体中选择了最简单的实现-具体体现在对远期利率使用对数正态 SDE(GBM)和驱动所有利率的波动性的单个 Wiener 过程(即，单因素情况)。 在这种情况下，我们进一步探索平价波动率的使用。

我们首先将利率*N*的期限结构划分为一组远期利率*L*和一组重置时间*T*，如下所示：

![Market models](../images/00055.jpeg)

前面的每个远期利率将有自己的随机过程驱动它们，这将导致*N*随机过程。 在 BGM 之后，我们使用几何布朗运动(BGM)(Brace，Gatarek 和 Musiela 1997)来描述这些随机过程，如下所示：

![Market models](../images/00056.jpeg)

方程式 8

我们现在进一步简化模型，使用一个单一因素来驱动所有远期汇率。 这种简化以后可以放松为多因素 LMM。 可以看出，通过选择最后一个速率作为终端测量，漂移具有如下形式：

![Market models](../images/00057.jpeg)

请注意，前面 GBM 方程中的漂移是远期速率的函数，因此不是恒定的，而是依赖于状态的。

考虑到 LMM 中过程的复杂性，不可能获得所有远期汇率的闭合形式的解。 然而，这不是问题，因为稳健的数值方法可以用来求解远期汇率的离散化版本。 被广泛用于市场模型的一个重要方法是**蒙特卡罗模拟**。 远期利率*Li(Tn)*是即期 LIBOR 利率的变现。 在每列中，使用以下离散化来更新前进速率*LI(Tn+1)*：

![Market models](../images/00058.jpeg)

方程式 9

前面的方程，就像我们给出的股票和外汇方程一样，应该用模拟迭代求解。 远期汇率可以在算术表中按如下方式排列：

![Market models](../images/00059.jpeg)

在上表中，左栏表示时间*t=0*的利率期限结构。 给定在此基础上实现的*T1*、*T2*、…的一组 LIBOR 利率。 *TN*，我们可以提取模拟所需的未来速率，就像上表的主对角线中显示的那样。

例如，考虑以下支付固定-浮动**利率互换**(**IRS**)，名义金额为 100 万欧元。 这个 IRS 每 3 个月支付 5%，每 3 个月收到 3 个月的欧洲银行同业拆借利率(EURIBOR)。 考虑到目前的利率期限结构，掉期的总期限为一年：

![Market models](../images/00060.jpeg)

使用 LMM 计算此掉期的现值。 我们该怎么继续呢？

*t=0*的即期利率期限结构为：*EURIBOR 3M=1%pa*，*EURIBOR 6M=2%pa*，*EURIBOR 9M=3%pa*，以及*EURIBOR 12M=4%pa*。

首先，我们需要通过自举计算从时间*t=0*观察到的初始远期速率。 我们使用下面的方程式来获得这个值：

![Market models](../images/00061.jpeg)

然后使用迭代公式 9，我们按如下方式计算未来的汇率：

![Market models](../images/00062.jpeg)

我们在最左侧的列中填充初始远期利率，并逐列向右推进，直到我们拥有所需的所有值，如右侧所示。 有关计算的更多细节，请参阅(Pelsser 2000)的书。 请注意，尽管 IRS 可以“静态”定价(即，无需模拟)，但我们使用此示例来说明 LMM 方法需要哪些步骤进行计算。

# 积分

在信用衍生品建模中，潜在的风险是信用风险。 现代信用风险度量方法可以分为两种可供选择的方法--由 Merton(1974)首创的结构方法和由多位作者首创的利用基于强度的模型估计随机风险率的简化形式方法，包括(Jrow 和 Turnbull 1995)、(Jrow，Lando 和 Turnbull 1997)和(Duffie 和 Singleton 1999)。

## 结构模型

信用风险的结构性方法假设，当一家公司的资产市值低于其必须支付的债务或债务时，该公司就会违约。 因此，结构模型有时也称为**资产价值模型**。 这些模型着眼于一家公司的资产负债表及其资本结构，以评估其信誉。 然而，这种方法的一个关键问题是，公司资产的价值很难直接观察。 年报只提供该公司实际资产的会计版本，而不提供其市值。 对于上市公司来说，股本通常是可以观察到的，其债务也是如此。 (Merton 1974)首先假设了以下形式的极其简化的资本结构：

![Structural models](../images/00063.jpeg)

方程式 10

在前面的等式中，*V*表示公司的价值(公司的总资产)，*E*是它的权益，*D*是它的债务。 权益*E*被理解为公司权益的总价值，等于一股(股票)的市值乘以市场上的股票数量。 对于这个简化的公司，债务由一个到期的零息债券*T*表示。

在这一点上，默顿提出了一个问题：“对于一家拥有之前资本结构的公司来说，它什么时候会违约？” 嗯，这取决于我们对违约的定义。 如果我们认为公司在未来某个特定时间*T*无法偿还债务的事实是违约的，那么如果公司在时间*T*的价值，即*V(T)*大于债务的面值*D(T)*，那么这个条件就会得到满足。 在这一时刻，债券持有人将要求付款，公司将准备好支付这笔款项。 相反，如果公司在到期时的价值低于它必须偿还的债务的价值，那么它将无法履行其义务，并将违约。 这两个场景可以在数学上定义如下：

![Structural models](../images/00064.jpeg)

那股权持有人呢？ 他们最终拥有了该公司的股票。 考虑到前两种情况，我们知道，如果公司违约，他们什么也得不到，而如果公司继续运营，他们在到期时收到*V(T)*和*D(T)*之间的差额，从而得出以下公式：

![Structural models](../images/00065.jpeg)

请注意，左边的表达式可以简洁地写成右边的单个表达式。 右边的表达式表示到期时对股权持有人的回报。 此外，该表达式与标的为*V(T)*和 Strike*D*的欧式看涨期权的收益形式完全相同。 在默顿之后，我们进一步假设公司的动态遵循 GBM，如下所示：

![Structural models](../images/00066.jpeg)

方程式 11

通过这样做，我们在信用风险和股权衍生品定价之间架起了一座桥梁。 事实上，我们现在可以使用股票衍生品定价的所有结果来为信用风险的结构性模型定价。 请注意，波动率![Structural models](../images/00015.jpeg)是公司的资产波动率，而不是股票波动率。 因此，公司在时间*t=0*的资产价值可以使用 Black-Scholes 公式计算如下：

![Structural models](../images/00067.jpeg)

方程式 12

![Structural models](../images/00068.jpeg)

在公式 12 中，*N()*是累积标准正态分布。 当我们需要计算一家公司的**首次公开募股(T4)(**IPO**)等问题，并根据公司的特征确定其股权的公平价格时，这是一个有用的表达式。**

例如，假设我们有一家公司，其资产总值为 1 亿美元。 无风险利率为 5%。 该公司资产的波动率假设为 20%。 其债务的面值为 7000 万美元，在四年内以零息债券的形式支付。 在时间*t=0*时，其股权的公允价值应该是多少？

我们使用信用风险结构模型的框架，并进行如下操作。 参数为![Structural models](../images/00069.jpeg)、![Structural models](../images/00070.jpeg)、![Structural models](../images/00071.jpeg)、![Structural models](../images/00072.jpeg)和![Structural models](../images/00073.jpeg)。 使用前面的公式，我们得到以下公式：

![Structural models](../images/00074.jpeg)

![Structural models](../images/00075.jpeg)

![Structural models](../images/00076.jpeg)

## 强度模型

默认值为随机变量 tau(*τ*)，表示公司违约的时间。 违约可以用破产、欠款等来形容。 要对信用事件的到达风险进行建模，我们需要对未知的随机时间点*τ*进行建模。

基于强度的模型直接关注于描述违约的条件概率，而不定义确切的违约事件。 强度模型基于生存概率的概念。 这是一个借用精算和生物科学的想法。 生存概率是一个衰减的指数函数，它描述了一个公司或一个国家(主权)生存多久的概率。 这可以用最简单的数学术语表示如下：

![Intensity models](../images/00077.jpeg)

方程式 13

但我们想要的是违约模型，而不是生存模型。 事实上，我们可以根据当前时间*t*计算未来某个时间段*[S，T]*的违约概率，简单地说就是两个连续生存概率之间的差值。 然后，可以使用以下公式计算未来期间违约概率![Intensity models](../images/00078.jpeg)：

![Intensity models](../images/00079.jpeg)

方程式 14

上述公式是信用风险建模的基础。 有了它们，我们可以描述违约的可能性，这是未来发生的概率事件。 因此，与这一未来事件相关的现金流取决于该事件的发生。 按照金融衍生品的经典框架，信用衍生品可以理解为或有债权，即触发未来现金流的事件是违约。

具体地说，考虑简化的情况-我们期望在未来某个时间*T*从一家公司收到单一现金流。 这笔现金流的现值是多少？

如果不考虑信用风险，现金流的**现值**(**PV**)就是现金流的贴现**未来值**(**FV**)。 如果中间时间的贴现率是 DF，那么我们可以写出金融学中最简单的公式，公式如下：

![Intensity models](../images/00080.jpeg)

我们可以更进一步，假设以恒定的无风险利率*r*连续复利，我们可以得到以下公式：

![Intensity models](../images/00081.jpeg)

方程式 15

如果我们考虑到公司的信用风险，现在会发生什么？ 首先要注意的是，现金流不再是确定的，但它是不确定的。 用数学术语来说，它不再是确定性的，但它是概率性的。 因此，我们应该改写以前的方程式。 但因为未来的现金流是未知的，所以它实际上是一个随机变量。 我们应该把它写成这个随机变量的期望值，如下所示：

![Intensity models](../images/00082.jpeg)

因此，这种预期引入了 FV 发生或不发生的概率。 但是这个概率是多少呢？ 该公司将来在那里付款的可能性。 换句话说，公司在此之前存活的概率，也就是它的生存概率。 因此，我们可以将![Intensity models](../images/00083.jpeg)替换为![Intensity models](../images/00084.jpeg)，以获得以下公式：

![Intensity models](../images/00085.jpeg)

此外，我们可以明确地表示前面描述的生存概率，如下所示：

![Intensity models](../images/00086.jpeg)

只有在公司存在的情况下，我们才会收到未来的现金流，然后在未来(或已经存活)这样做。 考虑到信用风险，现金流现值的最终表达式如下：

![Intensity models](../images/00087.jpeg)

方程式 16

最后一个表达式很有趣，因为它表明信用风险是一种“利差”，它被加到我们通常用来贴现未来现金流的无风险利率上。

例如，假设我们期望从信用风险为![Intensity models](../images/00088.jpeg)的交易对手那里收到 100 万美元，该交易对手的信用风险由其风险率量化。 假设无风险利率![Intensity models](../images/00089.jpeg)，首先计算无信用风险的现金流现值，其次计算有信用风险的现金流现值。 假设连续时间贴现。 假设回收率为![Intensity models](../images/00090.jpeg)。 我们该怎么继续呢？

通过应用前面的公式，我们得到在没有信用风险的情况下，*PV*如下：

![Intensity models](../images/00081.jpeg)

![Intensity models](../images/00091.jpeg)

现在，如果我们考虑信用风险，我们有*PV*如下：

![Intensity models](../images/00087.jpeg)

![Intensity models](../images/00092.jpeg)

请注意，第二个现金流小于第一个现金流。 信用风险的影响是认为今天的现金流的价值(其*PV*)是递减的，因为不确定，它必须乘以发生的几率(即其生存概率)。

在前面的分析中，我们假设当违约发生时，所有未来的现金流 FV 都将损失。 然而，在大多数实际情况下，会收回一部分钱。 如果我们将这个分数定义为回收率*R*，则风险未来现金流的现值*PV*仍然相同，如下所示：

![Intensity models](../images/00082.jpeg)

但现在根据两种可能的状态(违约或无违约)来解析预期，并将每种状态乘以其各自的概率，如下所示：

![Intensity models](../images/00093.jpeg)

在前面的等式中，我们已经考虑了违约情况下的回收率*R*。 风险现金流*PV*的现值如下：

![Intensity models](../images/00094.jpeg)

# 摘要

本章概述了现代金融市场中用于为衍生品定价的基本模型。 我们现在将以这些模型为基础，对我们审查的各种资产类别的基础进行建模，并应用一些数值方法在计算机中高效地执行它们的计算。

在下一章中，我们将集中讨论数值方法。